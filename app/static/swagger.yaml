swagger: "2.0"

info:
  title: "Mechanic Shop API"
  description: "API for managing customers, mechanics, service tickets, and inventory."
  version: "1.0.0"

host: "mec-1.onrender.com"
schemes:
  - "https"

consumes:
  - "application/json"
produces:
  - "application/json"


securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header
    description: "Enter **Bearer <token>**"


security:
  - Bearer: []

paths:

  
  /customers/:
    get:
      tags: [Customers]
      summary: "List all customers"
      description: "Returns a list of all customers in the system."
      responses:
        200:
          description: "Customer list"
          schema:
            type: array
            items:
              $ref: '#/definitions/Customer'

    post:
      tags: [Customers]
      summary: "Create a new customer"
      description: "Creates a new customer with required fields: name, email, phone, password."
      security: []   # Allow public signup
      parameters:
        - in: body
          name: customer
          required: true
          schema:
            $ref: '#/definitions/CustomerCreate'
          description: "Customer creation payload"
      responses:
        201:
          description: "Customer successfully created"
          schema:
            $ref: '#/definitions/Customer'
        400:
          description: "Validation error"

  /customers/login:
    post:
      tags: [Customers]
      summary: "Login"
      description: "Authenticates a customer and returns a JWT token."
      security: []   # login must be public
      parameters:
        - in: body
          name: credentials
          required: true
          schema:
            $ref: '#/definitions/LoginRequest'
      responses:
        200:
          description: "JWT Token"
          schema:
            $ref: '#/definitions/LoginResponse'
        401:
          description: "Invalid email or password."

  /customers/{customer_id}:
    get:
      tags: [Customers]
      summary: "Get customer by ID"
      description: "Returns a customer's details using the ID."
      parameters:
        - in: path
          name: customer_id
          type: integer
          required: true
      responses:
        200:
          description: "Customer data"
          schema:
            $ref: '#/definitions/Customer'
        404:
          description: "Customer not found"

    put:
      tags: [Customers]
      summary: "Update customer"
      description: "Fully updates a customer's details."
      parameters:
        - in: path
          name: customer_id
          type: integer
          required: true
        - in: body
          name: customer
          schema:
            $ref: '#/definitions/CustomerUpdate'
      responses:
        200:
          description: "Updated customer"
          schema:
            $ref: '#/definitions/Customer'
        404:
          description: "Customer not found"

    delete:
      tags: [Customers]
      summary: "Delete customer"
      description: "Deletes a customer by ID."
      parameters:
        - in: path
          name: customer_id
          type: integer
          required: true
      responses:
        200:
          description: "Customer deleted"
        404:
          description: "Customer not found"

  /customers/search-customers:
    get:
      tags: [Customers]
      summary: "Search customers"
      description: "Search customers by name or email."
      parameters:
        - in: query
          name: name
          type: string
        - in: query
          name: email
          type: string
      responses:
        200:
          description: "Search results"
          schema:
            type: array
            items:
              $ref: '#/definitions/Customer'

  

  /mechanics:
    get:
      tags: [Mechanics]
      summary: "List all mechanics"
      description: "Returns a list of all mechanics."
      responses:
        200:
          description: "Mechanic list"
          schema:
            type: array
            items:
              $ref: '#/definitions/Mechanic'

    post:
      tags: [Mechanics]
      summary: "Create mechanic"
      description: "Adds a new mechanic with name, email, and salary."
      parameters:
        - in: body
          name: mechanic
          required: true
          schema:
            $ref: '#/definitions/MechanicCreate'
      responses:
        201:
          description: "Mechanic created"
          schema:
            $ref: '#/definitions/Mechanic'
        400:
          description: "Validation error"

  /mechanics/{mechanic_id}:
    get:
      tags: [Mechanics]
      summary: "Get mechanic by ID"
      description: "Retrieves a mechanic's details."
      parameters:
        - in: path
          name: mechanic_id
          required: true
          type: integer
      responses:
        200:
          description: "Mechanic found"
          schema:
            $ref: '#/definitions/Mechanic'
        404:
          description: "Mechanic not found"

    put:
      tags: [Mechanics]
      summary: "Update mechanic"
      description: "Fully updates a mechanic's information."
      parameters:
        - in: path
          name: mechanic_id
          type: integer
          required: true
        - in: body
          name: mechanic
          schema:
            $ref: '#/definitions/MechanicUpdate'
      responses:
        200:
          description: "Updated mechanic"
          schema:
            $ref: '#/definitions/Mechanic'
        404:
          description: "Mechanic not found"

    patch:
      tags: [Mechanics]
      summary: "Partially update mechanic"
      description: "Updates only the provided fields for a mechanic."
      parameters:
        - in: path
          name: mechanic_id
          type: integer
          required: true
        - in: body
          name: mechanic
          schema:
            $ref: '#/definitions/MechanicUpdate'
      responses:
        200:
          description: "Updated mechanic"
          schema:
            $ref: '#/definitions/Mechanic'
        404:
          description: "Mechanic not found"

    delete:
      tags: [Mechanics]
      summary: "Delete mechanic"
      description: "Deletes a mechanic from the system."
      parameters:
        - in: path
          name: mechanic_id
          type: integer
          required: true
      responses:
        200:
          description: "Mechanic deleted"
        404:
          description: "Mechanic not found"

  

  /service_tickets:
    get:
      tags: [Service Tickets]
      summary: "List all service tickets"
      description: "Returns all service tickets currently in the system."
      responses:
        200:
          description: "All service tickets"
          schema:
            type: array
            items:
              $ref: '#/definitions/ServiceTicket'

    post:
      tags: [Service Tickets]
      summary: "Create service ticket"
      description: "Creates a new service ticket."
      parameters:
        - in: body
          name: ticket
          required: true
          schema:
            $ref: '#/definitions/ServiceTicketCreate'
      responses:
        201:
          description: "Service ticket created"
          schema:
            $ref: '#/definitions/ServiceTicket'

  /service_tickets/{ticket_id}:
    get:
      tags: [Service Tickets]
      summary: "Get service ticket"
      description: "Retrieves a service ticket by ID."
      parameters:
        - in: path
          name: ticket_id
          type: integer
          required: true
      responses:
        200:
          description: "Service ticket details"
          schema:
            $ref: '#/definitions/ServiceTicket'
        404:
          description: "Ticket not found"

    put:
      tags: [Service Tickets]
      summary: "Update service ticket"
      description: "Fully updates a service ticket."
      parameters:
        - in: path
          name: ticket_id
          type: integer
          required: true
        - in: body
          name: ticket
          schema:
            $ref: '#/definitions/ServiceTicketUpdate'
      responses:
        200:
          description: "Updated ticket"
          schema:
            $ref: '#/definitions/ServiceTicket'

    delete:
      tags: [Service Tickets]
      summary: "Delete service ticket"
      description: "Deletes a service ticket."
      parameters:
        - in: path
          name: ticket_id
          type: integer
          required: true
      responses:
        200:
          description: "Service ticket deleted"

  /service_tickets/{ticket_id}/assign_mechanic:
    post:
      tags: [Service Tickets]
      summary: "Assign mechanic"
      description: "Assigns a mechanic to a service ticket."
      parameters:
        - in: path
          name: ticket_id
          type: integer
          required: true
        - in: body
          name: assignment
          schema:
            $ref: '#/definitions/AssignMechanicRequest'
      responses:
        200:
          description: "Mechanic assigned"
          schema:
            $ref: '#/definitions/ServiceTicket'

  /service_tickets/{ticket_id}/remove_mechanic:
    post:
      tags: [Service Tickets]
      summary: "Remove mechanic"
      description: "Removes a mechanic from a service ticket."
      parameters:
        - in: path
          name: ticket_id
          type: integer
          required: true
        - in: body
          name: removal
          schema:
            $ref: '#/definitions/RemoveMechanicRequest'
      responses:
        200:
          description: "Mechanic removed"
          schema:
            $ref: '#/definitions/ServiceTicket'


  /inventory:
    get:
      tags: [Inventory]
      summary: "List inventory items"
      description: "Returns all inventory entries."
      responses:
        200:
          description: "Inventory list"
          schema:
            type: array
            items:
              $ref: '#/definitions/InventoryItem'

    post:
      tags: [Inventory]
      summary: "Create inventory item"
      description: "Adds a new inventory item."
      parameters:
        - in: body
          name: item
          required: true
          schema:
            $ref: '#/definitions/InventoryItemCreate'
      responses:
        201:
          description: "Item created"
          schema:
            $ref: '#/definitions/InventoryItem'

  /inventory/{item_id}:
    get:
      tags: [Inventory]
      summary: "Get inventory item"
      description: "Gets an inventory item by ID."
      parameters:
        - in: path
          name: item_id
          type: integer
          required: true
      responses:
        200:
          description: "Inventory item"
          schema:
            $ref: '#/definitions/InventoryItem'

    put:
      tags: [Inventory]
      summary: "Update inventory item"
      description: "Fully updates an inventory item."
      parameters:
        - in: path
          name: item_id
          type: integer
          required: true
        - in: body
          name: item
          schema:
            $ref: '#/definitions/InventoryItemUpdate'
      responses:
        200:
          description: "Updated item"
          schema:
            $ref: '#/definitions/InventoryItem'

    delete:
      tags: [Inventory]
      summary: "Delete inventory item"
      description: "Deletes an inventory item."
      parameters:
        - in: path
          name: item_id
          type: integer
          required: true
      responses:
        204:
          description: "Item deleted"


definitions:

  Customer:
    type: object
    properties:
      id: { type: integer }
      name: { type: string }
      email: { type: string }
      phone: { type: string }
    example:
      id: 1
      name: "John Doe"
      email: "john@example.com"
      phone: "555-1234"

  CustomerCreate:
    type: object
    required: [name, email, phone, password]
    properties:
      name: { type: string }
      email: { type: string }
      phone: { type: string }
      password: { type: string }
    example:
      name: "Alice"
      email: "alice@example.com"
      phone: "555-6789"
      password: "secure123"

  CustomerUpdate:
    type: object
    properties:
      name: { type: string }
      email: { type: string }
      phone: { type: string }
      password: { type: string }

  LoginRequest:
    type: object
    required: [email, password]
    properties:
      email: { type: string }
      password: { type: string }
    example:
      email: "john@example.com"
      password: "mypassword"

  LoginResponse:
    type: object
    properties:
      token: { type: string }

  Mechanic:
    type: object
    properties:
      id: { type: integer }
      name: { type: string }
      email: { type: string }
      salary: { type: number, format: float }

  MechanicCreate:
    type: object
    required: [name, email, salary]
    properties:
      name: { type: string }
      email: { type: string }
      salary: { type: number }
    example:
      name: "Mike Ross"
      email: "mike@example.com"
      salary: 65000

  MechanicUpdate:
    type: object
    properties:
      name: { type: string }
      email: { type: string }
      salary: { type: number }

  ServiceTicket:
    type: object
    properties:
      id: { type: integer }
      date: { type: string, format: date-time }
      customer_id: { type: integer }
      service_description: { type: string }
      mechanics:
        type: array
        items:
          $ref: '#/definitions/Mechanic'

  ServiceTicketCreate:
    type: object
    required: [customer_id, service_description]
    properties:
      customer_id: { type: integer }
      service_description: { type: string }
      mechanics:
        type: array
        items:
          type: integer

  ServiceTicketUpdate:
    type: object
    properties:
      service_description: { type: string }
      mechanics:
        type: array
        items:
          type: integer

  AssignMechanicRequest:
    type: object
    required: [mechanic_id]
    properties:
      mechanic_id: { type: integer }

  RemoveMechanicRequest:
    type: object
    required: [mechanic_id]
    properties:
      mechanic_id: { type: integer }

  InventoryItem:
    type: object
    properties:
      id: { type: integer }
      name: { type: string }
      quantity: { type: integer }

  InventoryItemCreate:
    type: object
    required: [name, quantity]
    properties:
      name: { type: string }
      quantity: { type: integer }

  InventoryItemUpdate:
    type: object
    properties:
      name: { type: string }
      quantity: { type: integer }
